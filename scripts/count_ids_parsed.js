const fs=require('fs');const path=require('path');const file=process.argv[2];if(!file){console.error('use: node count_ids_parsed.js <file>');process.exit(2);}const s=fs.readFileSync(file,'utf8');const marker='window.testData =';const idx=s.indexOf(marker);if(idx===-1){console.error('marker not found');process.exit(2);}const start=s.indexOf('{',idx);let i=start,depth=0,end=-1;for(;i<s.length;i++){const ch=s[i];if(ch==='{') depth++; else if(ch==='}') {depth--; if(depth===0){end=i;break;}}}if(end===-1){console.error('closing not found');process.exit(2);}const objText=s.slice(start,end+1);let data;try{data=JSON.parse(objText);}catch(e){const vm=require('vm');data=vm.runInNewContext('('+objText+')');}
const counts=new Map();let total=0;for(const catKey of Object.keys(data)){const cat=data[catKey];if(!cat.tests) continue;for(const test of cat.tests){if(!Array.isArray(test.questions)) continue;for(const q of test.questions){total++;counts.set(q.id,(counts.get(q.id)||0)+1);}}}
const duplicates=[];for(const [id,c] of counts.entries()){if(c>1) duplicates.push({id,c});}
console.log('Total parsed question objects:', total);console.log('Unique ids in parsed data:', counts.size);console.log('Duplicates in parsed data:',duplicates);
process.exit(0);
